# Traffic Flow Control System

A 4-way intersection traffic light controller with countdown timer display, implemented on the 8051 microcontroller.

## Overview

This project simulates a real-world traffic signal system that controls vehicle flow at a 4-way intersection. Each road gets a green signal in sequence, with countdown timers showing drivers how long until the signal changes.

## Intersection Layout

```
                      â•‘   â•‘   â•‘
                      â•‘   â•‘   â•‘
          ROAD 3      â•‘ â†“ â•‘   â•‘
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•”â•©â•â•â•â•©â•â•â•â•©â•—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                     â•‘ [R][Y][G]â•‘  â†â”€â”€ Traffic Light 3
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
              â†’ â†’    â•‘         â•‘
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                     â•‘[G][Y][R] â•‘  â†â”€â”€ Traffic Light 1
        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•šâ•¦â•â•â•â•¦â•â•â•â•¦â•â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          ROAD 1      â•‘   â•‘ â†‘ â•‘      ROAD 2
                      â•‘   â•‘   â•‘
                      â•‘   â•‘   â•‘
                         ROAD 4

        [â•â•â•â•â•â•]  [â•â•â•â•â•â•]
        [ TENS ]  [ UNITS]   â†â”€â”€ Countdown Display
        [â•â•â•â•â•â•]  [â•â•â•â•â•â•]
```

## Hardware Configuration

### Microcontroller
- **MCU**: Intel 8051/8052
- **Crystal**: 12 MHz
- **Ports Used**: P0, P1, P2, P3

### Pin Mapping

#### Port P0 - Traffic Lights (Roads 1 & 2)
```
Bit    Pin    Function
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 0     P0.0   Road 1 - GREEN
 1     P0.1   Road 1 - YELLOW
 2     P0.2   Road 1 - RED
 3     P0.3   (unused)
 4     P0.4   Road 2 - GREEN
 5     P0.5   Road 2 - YELLOW
 6     P0.6   Road 2 - RED
 7     P0.7   (unused)
```

#### Port P1 - Traffic Lights (Roads 3 & 4)
```
Bit    Pin    Function
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 0     P1.0   Road 3 - GREEN
 1     P1.1   Road 3 - YELLOW
 2     P1.2   Road 3 - RED
 3     P1.3   (unused)
 4     P1.4   Road 4 - GREEN
 5     P1.5   Road 4 - YELLOW
 6     P1.6   Road 4 - RED
 7     P1.7   (unused)
```

#### Ports P2 & P3 - Seven-Segment Displays
```
Port   Function
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 P2    Tens digit (0-4)
 P3    Units digit (0-9)
```

### Seven-Segment Display Wiring (Common Cathode)
```
        â”€â”€aâ”€â”€
       â”‚     â”‚
       f     b
       â”‚     â”‚
        â”€â”€gâ”€â”€
       â”‚     â”‚
       e     c
       â”‚     â”‚
        â”€â”€dâ”€â”€

    Segment:  a    b    c    d    e    f    g
    Bit:      0    1    2    3    4    5    6
```

## Traffic Light Sequence

The system cycles through 8 phases, alternating between green (40 seconds) and yellow (10 seconds) phases:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase â”‚   Road 1    â”‚   Road 2    â”‚   Road 3    â”‚   Road 4    â”‚ Countdown â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   1   â”‚   ğŸ”´ RED    â”‚   ğŸ”´ RED    â”‚   ğŸŸ¢ GREEN  â”‚   ğŸŸ¢ GREEN  â”‚  49 â†’ 10  â”‚
â”‚   2   â”‚   ğŸ”´ RED    â”‚   ğŸ”´ RED    â”‚   ğŸŸ¡ YELLOW â”‚   ğŸŸ¡ YELLOW â”‚  09 â†’ 00  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   3   â”‚   ğŸŸ¢ GREEN  â”‚   ğŸŸ¢ GREEN  â”‚   ğŸ”´ RED    â”‚   ğŸ”´ RED    â”‚  49 â†’ 10  â”‚
â”‚   4   â”‚   ğŸŸ¡ YELLOW â”‚   ğŸŸ¡ YELLOW â”‚   ğŸ”´ RED    â”‚   ğŸ”´ RED    â”‚  09 â†’ 00  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   5   â”‚   ğŸ”´ RED    â”‚   ğŸŸ¡ YELLOW â”‚   ğŸ”´ RED    â”‚   ğŸŸ¢ GREEN  â”‚  49 â†’ 10  â”‚
â”‚   6   â”‚   ğŸ”´ RED    â”‚   ğŸŸ¡ YELLOW â”‚   ğŸŸ¡ YELLOW â”‚   ğŸ”´ RED    â”‚  09 â†’ 00  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   7   â”‚   ğŸŸ¡ YELLOW â”‚   ğŸ”´ RED    â”‚   ğŸ”´ RED    â”‚   ğŸŸ¡ YELLOW â”‚  49 â†’ 10  â”‚
â”‚   8   â”‚   ğŸ”´ RED    â”‚   ğŸŸ¢ GREEN  â”‚   ğŸ”´ RED    â”‚   ğŸŸ¡ YELLOW â”‚  09 â†’ 00  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
                              (Cycle Repeats)
```

## State Machine Diagram

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                              â”‚
    â–¼                                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚Phase 1 â”‚â”€â”€â”€â–¶â”‚Phase 2 â”‚â”€â”€â”€â–¶â”‚Phase 3 â”‚â”€â”€â”€â–¶â”‚Phase 4 â”‚              â”‚
â”‚GREEN   â”‚ 40sâ”‚YELLOW  â”‚ 10sâ”‚GREEN   â”‚ 40sâ”‚YELLOW  â”‚ 10s          â”‚
â”‚Roads   â”‚    â”‚Roads   â”‚    â”‚Roads   â”‚    â”‚Roads   â”‚              â”‚
â”‚3 & 4   â”‚    â”‚3 & 4   â”‚    â”‚1 & 2   â”‚    â”‚1 & 2   â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
                                              â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
    â”‚                                                              â”‚
    â–¼                                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚Phase 5 â”‚â”€â”€â”€â–¶â”‚Phase 6 â”‚â”€â”€â”€â–¶â”‚Phase 7 â”‚â”€â”€â”€â–¶â”‚Phase 8 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚GREEN   â”‚ 40sâ”‚YELLOW  â”‚ 10sâ”‚GREEN   â”‚ 40sâ”‚YELLOW  â”‚ 10s
â”‚Roads   â”‚    â”‚Trans-  â”‚    â”‚Roads   â”‚    â”‚Trans-  â”‚
â”‚2 & 4   â”‚    â”‚ition   â”‚    â”‚1 & 3   â”‚    â”‚ition   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Circuit Schematic

```
                            +5V
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
                    â”‚    8051/8052    â”‚
                    â”‚                 â”‚
        XTAL1 â”€â”€â”€â”€â”€â”€â”¤                 â”‚
                    â”‚   P0.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 1 GREEN LED
        XTAL2 â”€â”€â”€â”€â”€â”€â”¤   P0.1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 1 YELLOW LED
                    â”‚   P0.2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 1 RED LED
          RST â”€â”€â”€â”€â”€â”€â”¤   P0.4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 2 GREEN LED
                    â”‚   P0.5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 2 YELLOW LED
          GND â”€â”€â”€â”€â”€â”€â”¤   P0.6 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 2 RED LED
                    â”‚                 â”‚
                    â”‚   P1.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 3 GREEN LED
                    â”‚   P1.1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 3 YELLOW LED
                    â”‚   P1.2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 3 RED LED
                    â”‚   P1.4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 4 GREEN LED
                    â”‚   P1.5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 4 YELLOW LED
                    â”‚   P1.6 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€[R]â”€â”€â–¶ Road 4 RED LED
                    â”‚                 â”‚
                    â”‚   P2.0-P2.6 â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â–¶ 7-Seg (TENS)
                    â”‚   P3.0-P3.6 â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â–¶ 7-Seg (UNITS)
                    â”‚                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                            GND

    [R] = 220Î© - 330Î© current limiting resistor
```

## Software Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         main()                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Main Loop                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚           State Machine (8 phases)              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  1. Load traffic light pattern from ROM         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  2. Output to P0 (Roads 1,2) and P1 (Roads 3,4)â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  3. Call display_countdown()                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  4. Toggle green/yellow phase flag              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  5. Move to next state                          â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    display_countdown()      â”‚    â”‚       delay_1sec()          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ For tens = start â†’ 0  â”‚  â”‚    â”‚  â”‚  Nested loop delay    â”‚  â”‚
â”‚  â”‚   For units = 9 â†’ 0   â”‚  â”‚â”€â”€â”€â–¶â”‚  â”‚  ~1 second @ 12MHz    â”‚  â”‚
â”‚  â”‚     Update P2, P3     â”‚  â”‚    â”‚  â”‚  50 Ã— 1275 iterations â”‚  â”‚
â”‚  â”‚     delay_1sec()      â”‚  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Memory Usage

| Section | Usage |
|---------|-------|
| CODE (ROM) | ~350 bytes |
| DATA (RAM) | ~10 bytes |
| XDATA | 0 bytes |

## Build Instructions

### Prerequisites
- SDCC (Small Device C Compiler)
- Make

### Install SDCC (Ubuntu/Debian)
```bash
sudo apt install sdcc
```

### Build
```bash
cd "Projects/Traffic Flow Control"
make
```

### Output
- `build/traffic.ihx` - Intel HEX file for programming/simulation

### Clean
```bash
make clean
```

## Simulation

1. Open `Proteus Files/Traffic Flow Control.pdsprj` in Proteus
2. Double-click the 8051 microcontroller
3. Load `build/traffic.ihx` as the program file
4. Click "Run" to start simulation

## Customization

### Adjust Timing
Edit these defines in `src/main.c`:
```c
#define COUNTDOWN_LONG     4    // Green phase: counts from 49 to 10
#define COUNTDOWN_SHORT    0    // Yellow phase: counts from 09 to 00
```

### Modify Delay
Adjust for different crystal frequencies:
```c
#define DELAY_OUTER_LOOP    50
#define DELAY_INNER_LOOP    1275
```

## License

Educational project - feel free to use and modify.
